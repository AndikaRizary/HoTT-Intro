\chapter{The circle}

We have seen inductive types, in which we describe a type by its constructors and an induction principle that allows us to construct sections of dependent types. Inductive types are freely generated by their constructors, which describe how we can construct their terms. 

However, many familiar constructions in algebra involve the construction of algebras by generators and relations. 
For example, the free abelian group with two generators is described as the group with generators $x$ and $y$, and the relation $xy=yx$. 

In this chapter we introduce higher inductive types, where we follow a similar idea: to allow in the specification of inductive types not only \emph{point constructors}, but also \emph{path constructors} that give us relations between the point constructors. 
The ideas behind the definition of higher inductive types are introduced by studying the simplest non-trivial example: the \emph{circle}.
Moreover, we show that the loop space of the circle is equivalent to $\mathbb{Z}$ by constructing the universal cover of the circle as an application of the univalence axiom. 

\section{The universal property of the circle}
The \emph{circle}\index{circle} is defined as a higher inductive type\index{higher inductive type} $\sphere{1}$\index{S 1@{$\sphere{1}$}} that comes equipped with\index{base@{$\base$}}\index{loop@{$\lloop$}}
\begin{align*}
\base & : \sphere{1} \\
\lloop & : \id{\base}{\base}.
\end{align*}
Just like for ordinary inductive types, the induction principle for higher inductive types provides us with a way of constructing sections of dependent types. However, we need to take the \emph{path constructor}\index{path constructor} $\lloop$ into account in the induction principle. 

By applying a section $f:\prd{t:\sphere{1}}P(t)$ to the base point of the circle, we obtain a term $f(\base):P(\base)$. Moreover, using the dependent action on paths\index{dependent action on paths} of $f$ of \autoref{defn:apd} we also obtain for any dependent function $f:\prd{t:\sphere{1}}P(t)$ a path
\begin{align*}
\apd{f}{\lloop} & : \id{\mathsf{tr}_P(\lloop,f(\base))}{f(\base)}
\end{align*}
in the fiber $P(\base)$.

\begin{defn}
Let $P$ be a type family over the circle. The \define{dependent action on generators}\index{dependent action on generators!for the circle|textbf} is the map\index{dgen_S1@{$\mathsf{dgen}_{\sphere{1}}$}|textbf}
\begin{equation}\label{eq:dgen_circle}
\mathsf{dgen}_{\sphere{1}}:\Big(\prd{t:\sphere{1}}P(t)\Big)\to\Big(\sm{y:P(\base)}\id{\mathsf{tr}_P(\lloop,y)}{y}\Big)
\end{equation}
given by $\mathsf{dgen}_{\sphere{1}}(f)\defeq\pairr{f(\base),\apd{f}{\lloop}}$.
\end{defn}

We now give the full specification of the circle.

\begin{defn}
The \define{circle}\index{circle|textbf} is a type $\sphere{1}$\index{S 1@{$\sphere{1}$}} that comes equipped with\index{base@{$\base$}}\index{loop@{$\lloop$}}
\begin{align*}
\base & : \sphere{1} \\
\lloop & : \id{\base}{\base},
\end{align*}
and satisfies the \define{induction principle of the circle}\index{induction principle!of the circle}, which provides for each type family $P$ over $\sphere{1}$ a map
\begin{equation*}
\ind{\sphere{1}}:\Big(\sm{y:P(\base)}\id{\mathsf{tr}_P(\lloop,y)}{y}\Big)\to \Big(\prd{t:\sphere{1}}P(t)\Big),
\end{equation*}
and a homotopy witnessing that $\ind{\sphere{1}}$ is a section of $\mathsf{dgen}_{\sphere{1}}$
\begin{equation*}
\mathsf{dgen}_{\sphere{1}}\circ \ind{\sphere{1}}\htpy \idfunc
\end{equation*}
for the computation rule\index{computation rules!of the circle}.
\end{defn}

\begin{rmk}
The induction principle of the circle provides us with a dependent function $f:\prd{t:\sphere{1}}P(t)$ equipped with an identification
\begin{equation*}
(f(\base),\apd{f}{\lloop})=(x,p),
\end{equation*}
for any $x : P(\base)$ and $p : \mathsf{tr}_P(\lloop,x)=x$. By \cref{thm:eq_sigma} the identification
$(f(\base),\apd{f}{\lloop})=(x,p)$ is equivalently described as a pair of identifications
\begin{samepage}
\begin{align*}
\alpha & : f(\base)= x \\
\beta & : \mathsf{tr}(\alpha,\apd{f}{\lloop}) = p.
\end{align*}\end{samepage}%
Here, the transport is taken with respect to the family $x\mapsto \mathsf{tr}_P(\lloop,x)=x$. 

The identity type $\mathsf{tr}(\alpha,\apd{f}{\lloop}) = p$ is equivalent to the type
\begin{equation*}
\ct{\apd{f}{\lloop}}{\alpha}=\ct{\mathsf{ap}_{\mathsf{tr}_P(\lloop)}(\alpha)}{p}.
\end{equation*}
Indeed, such an equivalence can be constructed by path induction, because types reduce to the type $\apd{f}{\lloop}=p$ when $\alpha\jdeq\refl{f(x)}$. Therefore we obtain from the computation rule of the circle an identification $\alpha:f(\base)=x$, and an identification
\begin{equation*}
\beta':\ct{\apd{f}{\lloop}}{\alpha}=\ct{\mathsf{ap}_{\mathsf{tr}_P(\lloop)}(\alpha)}{p}
\end{equation*}
witnessing that the square
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\mathsf{tr}_P(\lloop,f(\base)) \arrow[d,equals,swap,"\apd{f}{\lloop}"] \arrow[r,equals,"\ap{\mathsf{tr}_P(\lloop)}{\alpha}"] & \mathsf{tr}_P(\lloop,x) \arrow[d,equals,"p"] \\
f(\base) \arrow[r,equals,swap,"\alpha"] & x
\end{tikzcd}
\end{equation*}
commutes.
\end{rmk}

For the remainder of this section we establish the \define{universal property}\index{universal property!of the circle} of the circle. The proof of \cref{thm:circle_up} requires \cref{lem:circle_up_htpy,lem:circle_up_tr_compute}, which we state after we encounter their application.

\begin{thm}\label{thm:circle_up} 
For each type $X$, the \define{action on generators}\index{action on generators!for the circle}\index{gen_S1@{$\mathsf{gen}_{\sphere{1}}$}|textbf}
\begin{equation*}
\mathsf{gen}_{\sphere{1}}:(\sphere{1}\to X)\to \sm{x:X}x=x
\end{equation*}
given by $f\mapsto (f(\base),\ap{f}{\lloop})$ is an equivalence.
\end{thm}

\begin{proof}
Let $x:X$ and let $p:x=x$. By \cref{ex:trans_triv} we have an identification 
\begin{equation*}
\mathsf{tr\usc{}triv}(\lloop,x):\mathsf{tr}_{W_{\sphere{1}}X}(\lloop,x)=x,
\end{equation*}
from which we obtain a fiberwise equivalence
\begin{equation*}
\varphi : \prd{x:X} (x=x) \to (\mathsf{tr}_{W_{\sphere{1}}X}(\lloop,x)=x)
\end{equation*}
given by $p\mapsto \ct{\mathsf{tr\usc{}triv}(\lloop,x)}{p}$.
Moreover, for any $f:A\to B$, and any $p:x=y$ there is an identification $\ct{\mathsf{tr\usc{}triv}(p,f(x))}{\mathsf{ap}_f(p)}=\apd{f}{p}$, so it follows that the triangle
\begin{equation*}
\begin{tikzcd}[column sep=0]
& (\sphere{1}\to X) \arrow[dl,swap,"\mathsf{gen}_{\sphere{1}}"] \arrow[dr,swap,"\mathsf{dgen}_{\sphere{1}}" near start] \\
\sm{x:X}x=x \arrow[rr,"\total{\varphi}"',"\eqvsym"] & & \sm{x:X} \mathsf{tr}_{W_{\sphere{1}}X}(\lloop,x)=x \arrow[ul,densely dotted,bend right=15,swap,"\ind{\sphere{1}}"]
\end{tikzcd}
\end{equation*}
commutes, and the map $\total{\varphi}$ is a fiberwise equivalence by \cref{thm:fib_equiv}. Since the triangle commutes and $\ind{\sphere{1}}$ is a section of $\mathsf{dgen}_{\sphere{1}}$, it follows that the composite
\begin{equation*}
\rec{\sphere{1}}\defeq \ind{\sphere{1}}\circ \total{\varphi}
\end{equation*}
is a section of $\mathsf{gen}_{\sphere{1}}$. Therefore it remains to show that $\rec{\sphere{1}}$ is also a retraction of $\mathsf{gen}_{\sphere{1}}$, i.e.~we have to show that for every $f:\sphere{1}\to X$ there is an identification
\begin{equation*}
\rec{\sphere{1}}(\mathsf{gen}_{\sphere{1}}(f))=f.
\end{equation*}
In \cref{lem:circle_up_htpy} below we establish that
\begin{equation*}
(\mathsf{gen}_{\sphere{1}}(\rec{\sphere{1}}(\mathsf{gen}_{\sphere{1}}(f)))=\mathsf{gen}_{\sphere{1}}(f))\to (\rec{\sphere{1}}(\mathsf{gen}_{\sphere{1}}(f))=f).
\end{equation*}
We get an identification $\mathsf{gen}_{\sphere{1}}(\rec{\sphere{1}}(\mathsf{gen}_{\sphere{1}}(f)))=\mathsf{gen}_{\sphere{1}}(f)$ from the fact that $\rec{\sphere{1}}$ is a section of $\mathsf{gen}_{\sphere{1}}$.
\end{proof}

\begin{lem}\label{lem:circle_up_htpy}
Let $f,g:\sphere{1}\to X$ be two dependent functions. Then there is a map
\begin{equation*}
(\mathsf{gen}_{\sphere{1}}(f)=\mathsf{gen}_{\sphere{1}}(g))\to (f=g)
\end{equation*}
\end{lem}

\begin{proof}
Let $p:\mathsf{gen}_{\sphere{1}}(f)=\mathsf{gen}_{\sphere{1}}(g)$. By function extensionality, it suffices to show that $f\htpy g$. However, since $f\htpy g$ is just the type $\prd{t:\sphere{1}}f(t)=g(t)$, we can construct such a homotopy by $\sphere{1}$-induction. Thus, it suffices to construct a term of type
\begin{equation*}
\sm{p:f(\base)=g(\base)} \mathsf{tr}_{E_{f,g}}(\lloop,p)=p, 
\end{equation*}
where $E_{f,g}$ is the family over $\sphere{1}$ given by $t\mapsto f(t)=g(t)$.

We claim that it suffices to construct for each $p:f(\base)=g(\base)$ an equivalence
\begin{equation*}
\Big(\mathsf{tr}_{E_{f,g}}(\lloop,p)=p\Big)\eqvsym\Big(\mathsf{tr}_{L}(p,\ap{f}{\lloop})=\ap{g}{\lloop}\Big),
\end{equation*}
where $L$ is the family over $X$ given by $x\mapsto x=x$. 
To see that this suffices, we note that such a fiberwise equivalence induces an equivalence on total spaces, and the total space
\begin{align*}
\sm{p:f(\base)=g(\base)} \mathsf{tr}_{L}(p,\ap{f}{\lloop})=\ap{g}{\lloop},
\end{align*}
and is equivalent to $\mathsf{gen}(f)=\mathsf{gen}(g)$, of which we have assumed a term.

The asserted fiberwise equivalence that we need for this proof to go through requires a sufficient generalization so that it can be constructed by path induction, so it is established separately in \cref{lem:circle_up_tr_compute} below.
\end{proof}

\begin{comment}
Consider $f,g:\sphere{1}\to X$ with a homotopy $H:f\htpy g$. Then we have $H(\base):f(\base)=g(\base)$, and the square
\begin{equation*}
\begin{tikzcd}[column sep=large]
f(\base) \arrow[r,equals,"H(\base)"] \arrow[d,swap,equals,"\ap{f}{\lloop}"] & g(\base) \arrow[d,equals,"\ap{g}{\lloop}"] \\
f(\base) \arrow[r,equals,swap,"H(\base)"] & g(\base)
\end{tikzcd}
\end{equation*}
commutes by the naturality of homotopies, established in \cref{defn:htpy_nat}\index{naturality!of homotopies}. In the following lemma we will relate such squares in two ways to a transport, by generalizing the above situation sufficiently so that path induction becomes applicable. We will use these computations of transports to establish the universal property of the circle. 
\end{comment}

With the following lemma we complete the proof of the universal property of the circle. 

\begin{samepage}%
\begin{lem}\label{lem:circle_up_tr_compute} ~
\begin{enumerate}
\item Let $f,g:A \to B$, and let $E_{f,g}$ be the family over $A$ given by 
\begin{equation*}
E_{f,g}(x)\defeq f(x)=g(x).
\end{equation*}
Then for any $p:x=x'$ in $A$ there is an equivalence
\begin{equation*}
\eqv{(\mathsf{tr}_{E_{f,g}}(p,q)=q')}{(\ct{\ap{f}{p}}{q'}=\ct{q}{\ap{g}{p}})}.
\end{equation*}
for any $q:f(x)=g(x)$ and $q':f(x')=g(x')$. In other words, there is an identification $\mathsf{tr}_{E_{f,g}}(p,q)=q'$ if and only if the square
\begin{equation*}
\begin{tikzcd}
f(x) \arrow[r,equals,"q"] \arrow[d,equals,swap,"\ap{f}{p}"] & g(x) \arrow[d,equals,"\ap{g}{p}"] \\
f(x') \arrow[r,equals,swap,"{q'}"] & g(x') 
\end{tikzcd}
\end{equation*}
commutes.
\item Let $L$ be the family over $B$ given by $L(y)\defeq y=y$, and let $q:y=y'$ be an identification in $B$. Then there is an equivalence
\begin{equation*}
\eqv{(\mathsf{tr}_L(q,p)=p')}{(\ct{q}{p'}=\ct{p}{q})}. 
\end{equation*}
for any $p:y=y$ and $p':y'=y'$. In other words, there is an identification $\mathsf{tr}_L(q,p)=p'$ if and only if the square
\begin{equation*}
\begin{tikzcd}
y \arrow[r,equals,"p"] \arrow[d,swap,equals,"q"] & y \arrow[d,equals,"q"] \\
y' \arrow[r,equals,swap,"{p'}"] & y'
\end{tikzcd}
\end{equation*}
commutes.
\item Let $f,g:A \to B$, let $p:x=x$ be a loop in $A$, and let $q:f(x)=g(x)$. Then there is an equivalence
\begin{equation*}
\eqv{(\mathsf{tr}_{E_{f,g}}(p,q)=q)}{(\mathsf{tr}_L(q,\ap{f}{p})=\ap{g}{p}).}
\end{equation*}
\end{enumerate}
\end{lem}
\end{samepage}%

\begin{proof}
The first claim follows by path induction on $p$, and the second claim follows by path induction on $q$. The third claim follows by combining the first two, since the types on both sides are equivalent to the type
\begin{equation*}
\ct{\ap{f}{p}}{q}=\ct{q}{\ap{g}{p}}
\end{equation*}
of witnesses that the square
\begin{equation*}
\begin{tikzcd}[column sep=large]
f(x) \arrow[r,equals,"q"] \arrow[d,swap,equals,"\ap{f}{p}"] & g(x) \arrow[d,equals,"\ap{g}{p}"] \\
f(x) \arrow[r,equals,swap,"q"] & g(x)
\end{tikzcd}
\end{equation*}
commutes.
\end{proof}

\section{The fundamental cover of the circle}

The \emph{fundamental cover}\index{fundamental cover!of the circle} of the circle is a family of sets over the circle with contractible total space.
Classically, the fundamental cover is described as a map $\mathbb{R}\to\sphere{1}$ that winds the real line around the circle.
In homotopy type theory there is no analogue of such a construction.

The type of small families over $\sphere{1}$ is just the function type $\sphere{1}\to\UU$, so in fact we may use the universal property of the circle to construct small dependent types over the circle. 
By the universal property, small type families over $\sphere{1}$ are equivalently described as pairs $(X,p)$ consisting of a type $X:\UU$ and an identification $p:X=X$.
This is where the univalence axiom\index{univalence axiom!families over $\sphere{1}$} comes in. By the map
\begin{equation*}
\mathsf{eq\usc{}equiv}_{X,X}:(\eqv{X}{X})\to (X=X)
\end{equation*}
it suffices to provide an equivalence $\eqv{X}{X}$.

\begin{defn}\label{defn:circle_descent}
Consider a type $X$ and every equivalence $e:\eqv{X}{X}$.
We will construct a dependent type $\mathcal{D}(X,e):\sphere{1}\to\UU$ with an equivalence $x\mapsto x_{\mathcal{D}}:\eqv{X}{\mathcal{D}(X,e,\base)}$ for which the square
\begin{equation*}
\begin{tikzcd}
X \arrow[r,"\eqvsym"] \arrow[d,swap,"e"] & \mathcal{D}(X,e,\base) \arrow[d,"\mathsf{tr}_{\mathcal{D}(X,e)}(\lloop)"] \\
X \arrow[r,swap,"\eqvsym"] & \mathcal{D}(X,e,\base)
\end{tikzcd}
\end{equation*}
commutes. We also write $d\mapsto d_{X}$ for the inverse of this equivalence, so that the relations
\begin{samepage}%
\begin{align*}
(x_{\mathcal{D}})_X & =x & (e(x)_{\mathcal{D}}) & = \mathsf{tr}_{\mathcal{D}(X,e)}(\lloop,x_{\mathcal{D}}) \\
(d_X)_{\mathcal{D}} & =d & (\mathsf{tr}_{\mathcal{D}(X,e)}(d))_X & = e(d_X)
\end{align*}
\end{samepage}%
hold.

The type $\sm{X:\UU}\eqv{X}{X}$ is also called the type of \define{descent data}\index{descent data!for the circle|textbf} for the circle.
\end{defn}

\begin{constr}
By \autoref{ex:tr_ap} we have an identification
\begin{equation*}
\mathsf{equiv\usc{}eq}(\ap{P}{\lloop})=\mathsf{tr}_P(\lloop)
\end{equation*}
for each dependent type $P:\sphere{1}\to\UU$. Therefore we see that the triangle\index{desc_S1@{$\mathsf{desc}_{\sphere{1}}$}}
\begin{equation*}
\begin{tikzcd}
& (\sphere{1}\to \UU) \arrow[dl,swap,"\mathsf{gen}_{\sphere{1}}"] \arrow[dr,"\mathsf{desc}_{\sphere{1}}"] \\
\sm{X:\UU}X=X \arrow[rr,swap,"\total{\lam{X}\mathsf{equiv\usc{}eq}_{X,X}}"] & & \sm{X:\UU}\eqv{X}{X}
\end{tikzcd}
\end{equation*}
commutes, where the map $\mathsf{desc}_{\sphere{1}}$ is given by $P\mapsto\pairr{P(\base),\mathsf{tr}_P(\lloop)}$ and the bottom map is an equivalence by the univalence axiom and \cref{thm:fib_equiv}.
Now it follows by the 3-for-2 property that $\mathsf{desc}_{\sphere{1}}$ is an equivalence, since $\mathsf{gen}_{\sphere{1}}$ is an equivalence by \cref{thm:circle_up}.
This means that for every type $X$ and every $e:\eqv{X}{X}$ there is a type family $\mathcal{D}(X,e):\sphere{1}\to\UU$ such that
\begin{equation*}
\pairr{\mathcal{D}(X,e,\base),\mathsf{tr}_{\mathcal{D}(X,e)}(\lloop)}=\pairr{X,e}.
\end{equation*}
Equivalently, we have $p:\id{\mathcal{D}(X,e,\base)}{X}$ and $\mathsf{tr}(p,{\mathsf{tr}_{\mathcal{D}(X,e)}(\lloop)})=e$. Thus, we obtain $\mathsf{equiv\usc{}eq}(p):\eqv{\mathcal{D}(X,e,\base)}{X}$, for which the square
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\mathcal{D}(X,e,\base)\arrow[r,"\mathsf{equiv\usc{}eq}(p)"] \arrow[d,swap,"\mathsf{tr}_{\mathcal{D}(X,e)}(\lloop)"] & X \arrow[d,"e"] \\
\mathcal{D}(X,e,\base)\arrow[r,swap,"\mathsf{equiv\usc{}eq}(p)"] & X
\end{tikzcd}
\end{equation*}
commutes.
\end{constr}

\begin{comment}
\begin{defn}\label{defn:fiber_sequence}
A \define{fiber sequence} 
\begin{equation*}
F \hookrightarrow E \twoheadrightarrow B
\end{equation*}
consists of a \define{base type} $B$ with a base point $b_0$ and a dependent type $P:B\to\type$, a type $F$ called the \define{fiber} with an equivalence $\eqv{P(b_0)}{F}$, and a type $E$ called the \define{total space} with a map $p:E\to B$ and an equivalence $e:\eqv{(\sm{b:B}P(b))}{E}$ such that the triangle
\begin{equation*}
\begin{tikzcd}
\Big(\sm{b:B}P(b)\Big) \arrow[rr,"e"] \arrow[dr,swap,"\proj 1"] & & E \arrow[dl,"p"] \\
& B
\end{tikzcd}
\end{equation*}
commutes.
\end{defn}
\end{comment}

Recall from \cref{ex:succ_equiv} that the successor function $\mathsf{succ}:\Z\to \Z$ is an equivalence. Its inverse is the predecessor function defined in \cref{ex:int_pred}. 

\begin{defn}
The \define{fundamental cover}\index{fundamental cover!of the circle|textbf} of the circle is the dependent type $\mathcal{E}_{\sphere{1}}\defeq\mathcal{D}(\Z,\mathsf{succ}):\sphere{1}\to\UU$.\index{Z@{$\Z$}!fundamental cover of S1@{fundamental cover of $\sphere{1}$}}\index{E_S1@{$\mathcal{E}_{\sphere{1}}$}|textbf}
\end{defn}

The picture of the fundamental cover is that of a helix\index{helix} over the circle.

\begin{lem}
For any $k:\Z$, there is an identification
\begin{equation*}
s_k:(\base,k_{\mathcal{E}})=(\base,\mathsf{succ}(k)_{\mathcal{E}})
\end{equation*}
in the total space $\sm{t:\sphere{1}}\mathcal{E}(t)$.
\end{lem}

\begin{proof}
By \cref{thm:eq_sigma} it suffices to show that
\begin{equation*}
\prd{k:\Z} \sm{\alpha:\base=\base} \mathsf{tr}_{\mathcal{E}}(\alpha,k_{\mathcal{E}})= \mathsf{succ}(k)_{\mathcal{E}}.
\end{equation*}
We just take $\alpha\defeq\lloop$. Then we have $\mathsf{tr}_{\mathcal{E}}(\alpha,k_{\mathcal{E}})= \mathsf{succ}(k)_{\mathcal{E}}$ by the commuting square provided in the definition of $\mathcal{E}$.
\end{proof}

Our goal in this section is to show that the total space of the fundamental cover is contractible. We will use the following elimination principle for the integers.

\begin{lem}
Let $B$ be a family over $\Z$, equipped with a term $b_0:B(0)$, and an equivalence
\begin{equation*}
e_k : B(k)\eqvsym B(\mathsf{succ}(k))
\end{equation*}
for each $k:\Z$. Then there is a dependent function $f:\prd{k:\Z}B(k)$ equipped with identifications $f(0)=b_0$ and
\begin{equation*}
f(\mathsf{succ}(k))=e_k(f(k))
\end{equation*}
for any $k:\Z$.
\end{lem}

\begin{proof}
The map is defined using the induction principle for the integers, stated in \cref{lem:Z_ind}. First we take
\begin{align*}
f(-1) & \defeq e^{-1}(b_0) \\
f(0) & \defeq b_0 \\
f(1) & \defeq e(b_0).
\end{align*}
For the induction step on the negative integers we use
\begin{equation*}
\lam{n}e_{\mathsf{neg}(S(n))}^{-1} : \prd{n:\N} B(\mathsf{neg}(n))\to B(\mathsf{neg}(S(n)))
\end{equation*}
For the induction step on the positive integers we use
\begin{equation*}
\lam{n}e(\mathsf{pos}(n)) : \prd{n:\N} B(\mathsf{pos}(n))\to B(\mathsf{pos}(S(n))).
\end{equation*}
The computation rules follow in a straightforward way from the computation rules of $\Z$-induction and the fact that $e^{-1}$ is an inverse of $e$. 
\end{proof}

\begin{eg}
For any type $A$, we obtain a map $f:\Z\to A$ from any $x:A$ and any equivalence $e:\eqv{A}{A}$, such that $f(0)=x$ and the square
\begin{equation*}
\begin{tikzcd}
\Z \arrow[d,swap,"\mathsf{succ}"] \arrow[r,"f"] & A \arrow[d,"e"] \\
\Z \arrow[r,swap,"f"] & A
\end{tikzcd}
\end{equation*}
commutes. In particular, if we take $A\jdeq (x=x)$ for some $x:X$, then for any $p:x=x$ we have the equivalence $\lam{q}\ct{p}{q}:(x=x)\to (x=x)$. This equivalence induces the map
\begin{equation*}
k\mapsto p^k : \Z \to (x=x).
\end{equation*}
\end{eg}

\begin{thm}\label{thm:circle_fundamental}
The total space $\sm{t:\sphere{1}}\mathcal{E}(t)$ of the fundamental cover of $\sphere{1}$ is contractible.
\end{thm}

\begin{proof}
We show that the total space satisfies singleton induction (i.e.~we apply \cref{thm:contractible}). Let $P$ be a family over the total space of the fundamental cover, and let $p_0:P(\base,0_{\mathcal{E}})$. Our goal is to construct a term of type
\begin{equation*}
\prd{t:\sphere{1}}{x:\mathcal{E}(t)} P(t,x).
\end{equation*}
We do this by induction. For the base case we must construct a term of type
\begin{equation*}
\prd{k:\Z}P(\base,k_{\mathcal{E}}).
\end{equation*}
Since we have the identifications $s_k: (\base,k_{\mathcal{E}})=(\base,\mathsf{succ}(k)_{\mathcal{E}})$, we have the equivalences
\begin{equation*}
\mathsf{tr}_P(s_k) : \eqv{P(\base,k_{\mathcal{E}})}{P(\base,\mathsf{succ}(k)_{\mathcal{E}})}
\end{equation*}
for each $k:\Z$. Thus we obtain a dependent function $f:\prd{x:\mathcal{E}(\base)}P(\base,x)$ satisfying $f(0_{\mathcal{E}})=p_0$ and $f(\mathsf{succ}(k)_{\mathcal{E}})=\mathsf{tr}_P(s_k,f(k_{\mathcal{E}}))$, for each $k:\Z$. 

For the loop case we must show that
\begin{equation*}
\mathsf{tr}_Q(\lloop,f)=f,
\end{equation*}
where $Q$ is the family over $\sphere{1}$ given by $Q(t)\defeq \prd{x:\mathcal{E}(t)} P(t,x)$. By function extensionality it suffices to construct a homotopy, and the transport along $\lloop$ in $Q$ computes as
\begin{equation*}
\mathsf{tr}_Q(\lloop,f)(k_{\mathcal{E}})= \mathsf{tr}_P(s_k,f(\mathsf{succ}^{-1}(k)_{\mathcal{E}})). 
\end{equation*}
Therefore the following computation completes the proof:
\begin{align*}
\mathsf{tr}_Q(\lloop,f)(k_{\mathcal{E}})
& = \mathsf{tr}_P(s_k,f(\mathsf{succ}^{-1}(k)_{\mathcal{E}})) \\
& = f(\mathsf{succ}(\mathsf{succ}^{-1}(k))_{\mathcal{E}}) \\
& = f(k_{\mathcal{E}}).\qedhere
\end{align*}
\end{proof}

\begin{cor}\label{cor:circle_loopspace}
We have a fiber sequence
\begin{equation*}
\Z \hookrightarrow \unit \twoheadrightarrow \sphere{1}.
\end{equation*}
In other words: the loop space $\loopspace{\sphere{1}}$ of the circle is equivalent to $\Z$.\index{identity type!of the circle}
\end{cor}

\begin{proof}
This follows from \cref{thm:circle_fundamental} by an application of \cref{thm:id_fundamental}.
\end{proof}

\begin{cor}
The circle is a $1$-type and it is not a $0$-type.\index{circle!is a 1-type@{is a $1$-type}|textit}
\end{cor}

\begin{exercises}
\item \label{ex:circle_up_pushout}Show that
\begin{equation*}
\begin{tikzcd}[column sep=huge]
X^{\sphere{1}} \arrow[r,"\blank\circ\mathsf{const}_{\base}"] \arrow[d,swap,"\blank\circ\mathsf{const}_{\base}"] & X^\unit \arrow[d,"\blank\circ\mathsf{const}_{\ttt}"] \\
X^\unit \arrow[r,swap,"\blank\circ\mathsf{const}_{\ttt}"] & X^\bool
\end{tikzcd}
\end{equation*}
is a pullback square for each type $X$.
\item \label{ex:circle_dup}In this exercise we establish the \emph{dependent universal property} of the circle, analogous to the proof of \cref{thm:circle_up}.
\begin{subexenum}
\item Let $f,g:\prd{x:A}B(x)$, and let $E_{f,g}$ be the family over $A$ given by 
\begin{equation*}
E_{f,g}(x)\defeq f(x)=g(x).
\end{equation*}
Construct for any $p:x=x'$ in $A$ an equivalence
\begin{equation*}
\eqv{(\mathsf{tr}_{E_{f,g}}(p,q)=q')}{(\ct{\apd{f}{p}}{q'}=\ct{\ap{\mathsf{tr}_B(p)}{q}}{\apd{g}{p}})}.
\end{equation*}
for any $q:f(x)=g(x)$ and $q':f(x')=g(x')$.
\item Let $B$ be a family over $A$, and for $l:x=_A x$ let $L_x$ be the family over $B(x)$ given by 
\begin{equation*}
L_x(y)\defeq \mathsf{tr}_B(l,y)=y.
\end{equation*}
Furthermore, let $q:y=y'$ be an identification in $B(x)$. 
Construct an equivalence
\begin{equation*}
\eqv{(\mathsf{tr}_{L_x}(q,p)=p')}{(\ct{\ap{\mathsf{tr}_B(l)}{q}}{p'}=\ct{p}{q})}. 
\end{equation*}
for any $p:\mathsf{tr}_B(l,y)=y$ and $p':\mathsf{tr}_B(l,y')=y'$.
\item Let $f,g:\prd{x:A}B(x)$, let $p:x=x$ be a loop in $A$, and let $q:f(x)=g(x)$. 
Construct an equivalence
\begin{equation*}
\eqv{(\mathsf{tr}_{E_{f,g}}(p,q)=q)}{(\mathsf{tr}_{L_x}(q,\apd{f}{p})=\apd{g}{p}).}
\end{equation*}
\item Show that for any $f,g:\prd{t:\sphere{1}}P(t)$ there is a function
\begin{equation*}
\Big(\mathsf{dgen}_{\sphere{1}}(f)=\mathsf{dgen}_{\sphere{1}}(g)\Big)\to (f=g).
\end{equation*}
\item Show that for any type family $P$ over $\sphere{1}$, the \emph{dependent action on generators}
\begin{equation*}
\Big(\prd{t:\sphere{1}}P(t)\Big)\to \sm{u:P(\base)}\mathsf{tr}_P(\lloop,u)=u
\end{equation*}
is an equivalence.
\end{subexenum}
\item Let $P:\sphere{1}\to\prop$ be a family of propositions over the circle. Show that
\begin{equation*}
P(\base)\to\prd{t:\sphere{1}}P(t).
\end{equation*}
In this sense the circle is \emph{connected}.
\item Show that
\begin{equation*}
\prd{x,y:\sphere{1}}\neg\neg(x=y).
\end{equation*}
\item Use the fundamental cover of the circle to show that
\begin{equation*}
\neg\Big(\prd{t:\sphere{1}}\base=t\Big).
\end{equation*}
\item \label{ex:circle_constant}
Show that for any type $X$ and any $x:X$, the map
\begin{equation*}
\rec{\sphere{1}}(x,\refl{x}):\sphere{1}\to X
\end{equation*}
is homotopic to the constant map $\mathsf{const}_x$.
\item \label{ex:circle_degk}
\begin{subexenum}
\item Show that for every $x:X$, we have an equivalence
\begin{equation*}
\eqv{\Big(\sm{f:\sphere{1}\to X}f(\base)= x \Big)}{(x=x)}
\end{equation*}
\item Show that for every $t:\sphere{1}$, we have an equivalence
\begin{equation*}
\eqv{\Big(\sm{f:\sphere{1}\to \sphere{1}}f(\base)= t \Big)}{\Z}
\end{equation*}
The base point preserving map $f:\sphere{1}\to\sphere{1}$ corresponding to $k:\Z$ is called the \define{degree $k$ map} on the circle, and is denoted by $\mathsf{deg}(k)$.
\item Show that for every $t:\sphere{1}$, we have an equivalence
\begin{equation*}
\eqv{\Big(\sm{e:\eqv{\sphere{1}}{\sphere{1}}}e(\base)= t \Big)}{\bool}
\end{equation*}
\end{subexenum}
\item \label{ex:circle_double_cover} The \define{(twisted) double cover} of the circle is defined as the type family $\mathcal{T}\defeq\mathcal{D}(\bool,\mathsf{neg}):\sphere{1}\to\UU$, where $\mathsf{neg}:\eqv{\bool}{\bool}$ is the negation equivalence of \autoref{ex:neg_equiv}.
\begin{subexenum}
\item Show that $\neg(\prd{t:\sphere{1}}\mathcal{T}(t))$.
\item Construct an equivalence $e:\eqv{\sphere{1}}{\sm{t:\sphere{1}}\mathcal{T}(t)}$ for which the triangle
\begin{equation*}
\begin{tikzcd}
\sphere{1} \arrow[rr,"e"] \arrow[dr,swap,"\mathsf{deg}(2)"] & & \sm{t:\sphere{1}}\mathcal{T}(t) \arrow[dl,"\proj 1"] \\
& \sphere{1}
\end{tikzcd}
\end{equation*}
commutes.
\end{subexenum}
\item \label{ex:circle_connected}
\begin{subexenum}
\item Show that a type $X$ is a set if and only if the map
\begin{equation*}
\lam{x}{t} x : X \to (\sphere{1}\to X)
\end{equation*}
is an equivalence.
\item Show that a type $X$ is a set if and only if the map
\begin{equation*}
\lam{f}f(\base) : (\sphere{1}\to X)\to X
\end{equation*}
is an equivalence.
\end{subexenum}
\item Show that $\eqv{(\eqv{\sphere{1}}{\sphere{1}})}{\sphere{1}+\sphere{1}}$. Conclude that a univalent universe containing a circle is not a $1$-type.
\item Show that any retract of the circle is equivalent to the circle.
\item \label{ex:is_invertible_id_S1}
\begin{subexenum}
\item Construct a fiberwise equivalence
\begin{equation*}
\prd{t:\sphere{1}} \big(\eqv{(t=t)}{\Z}\big).
\end{equation*}
\item Use \cref{ex:circle_connected} to show that $\eqv{(\idfunc[\sphere{1}]\htpy\idfunc[\sphere{1}])}{\Z}$.
\item Use \cref{ex:idfunc_autohtpy} to show that
\begin{equation*}
\eqv{\mathsf{is\usc{}invertible}(\idfunc[\sphere{1}])}{\Z},
\end{equation*}
and conclude that ${\mathsf{is\usc{}invertible}}(\idfunc[\sphere{1}])\not\simeq{\isequiv(\idfunc[\sphere{1}])}$. 
\end{subexenum}
\end{exercises}
